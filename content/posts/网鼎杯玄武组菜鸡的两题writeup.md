---
title: "网鼎杯玄武组菜鸡的两题writeup"
date: 2020-05-28T20:46:10+08:00
tags: ["ctf", "writeup"]
categories: ["技术"]
---

# 签到题

## 操作内容

此题writeup来自队友。

进入容器，首先按 Ctrl+U 查看页面源码，发现存在js脚本[css/game_manager.js](http://578f4cd5c5f143e48046562a9ff01bdbc05a630dd1404d2c.cloudgame1.ichunqiu.com/css/game_manager.js)，点击查看内容，全局搜索php，寻找脚本文件，发现p14.php文件。为ajax请求，post方式提交token和success数据，在全局搜索token，寻找token从何而来，发现

```php
var token=prompt("\x70\x6c\x65\x61\x73\x65 \x69\x6e\x70\x75\x74 \x79\x6f\x75\x72 \x74\x65\x61\x6d \x54\x6f\x6b\x65\x6e\x3a")
```

解码后为：please input your team Token。故token的值为本队的token。然后success输入data，获取flag。

![img](clip_image002.jpg)

```python
import requests


def main():
    url = 'http://3753a676b7af4cb58babe5fd155b111095c2522636aa4088.cloudgame1.ichunqiu.com//p14.php'
    data = {
        'token': 'icq64bf382a324a01f7c6e7434e9ec3f',
    }
    res = requests.post(url, data)
    print(res.text)


if __name__ == '__main__':
    main()
```

```
flag{4d8907b3b57f27449a869871734b9f68}
```

# sudo

## 操作内容

首先解压文件可得到名为sudo.ps1的powershell脚本，经分析可得该脚本经过混淆，因此应先解混淆而后再分析脚本的执行流程。

1. 将`sudo.ps1`的`| &( $sHeLlid[1]+$SHELLId[13]+'x')`语句删除，重定向输出为`2.ps1`文件。
2. 将`2.ps1`的`.( $ShELlid[1]+$SHellId[13]+'x')`语句删除，重定向输出为`3.ps1`文件。
3. 将`3.ps1`的`| .((VARiABLe '*Mdr*').naMe[3,11,2]-jOIn'')`语句删除，重定向输出为`4.ps1`文件。
4. 将`4.ps1`的`|. ( $EnV:COmSpeC[4,24,25]-JOin'')`语句删除，重定向输出为`5.ps1`文件。
5. 此时代码已接近可读，此时发现${su\`DO\`Ku}为二维数组，且二维数组与9*9数独有联系，与下文代码联合分析后，猜测只有当${su\`DO\`Ku}正确时才不会输出`(wrong key)`。通过使用`https://www.thonky.com/sudoku/solution-count`的算法解出共有340个可用二维数组，存入`solution.txt`文件保存，因此在`5.ps1`的基础上改写脚本。脚本从`solution.txt`中读取全部可能的解法，对所有解法进行爆破，所有爆破结果中只有一个回显得flag。

`solution.txt`中所有可能的数独解法

```
326784951815692437497153628273946185954821376681375294748219563532468719169537842
326784951815692437497153628273946185954821376681537294748219563532468719169375842
326784951815692437497153628671349582954821376283576194748915263532468719169237845
326784951815692437497153628673549182954821376281376594748915263532468719169237845
326784951815692437497153628673945182954821376281376594748519263532468719169237845
326784951815692734497153628273549186964821375581367492748915263632478519159236847
326784951815692734497153628273945186964821375581367492748519263632478519159236847
326784951815692734497153628571369482964821375283547196748915263632478519159236847
326847951815692437497153628971536284254981376683724195748219563532468719169375842
326847951815692437497153628973526184254981376681374295748219563532468719169735842
326847951815692437497153628973526184254981376681734295748219563532468719169375842
326847951815692437497351628671239584954186372283574196748915263532468719169723845
326847951815692437497351628971234586654189372283576194748915263532468719169723845
326847951815692437497351628971236584254189376683574192748915263532468719169723845
326847951815692437497351628971236584654189372283574196748915263532468719169723845
326847951815692437497351628271934586954186372683275194748519263532468719169723845
326847951815692437497351628271934586954186372683725194748519263532468719169273845
326847951815692437497351628673529184954186372281734596748915263532468719169273845
326847951815692437497351628673925184954186372281734596748519263532468719169273845
326847951815692437497351628973524186654189372281736594748915263532468719169273845
326847951815692437497351628973526184254189376681734592748915263532468719169273845
326847951815692437497351628973526184654189372281734596748915263532468719169273845
326847951815692734497153628271935486964281375583764192748519263632478519159326847
326847951815692734497153628971235486264981375583764192748519263632478519159326847
326847951815692734497153628971235486564981372283764195748519263632478519159326847
326847951815692734497153628971325486264981375583764192748519263632478519159236847
326847951815692734497153628971325486564981372283764195748519263632478519159236847
326847951815692734497153628971365482264981375583724196748519263632478519159236847
326847951815692734497153628271369485964581372583724196748915263632478519159236847
326847951815692734497153628271539486964281375583764192748915263632478519159326847
326847951815692734497153628571239486964581372283764195748915263632478519159326847
326847951815692734497153628571329486964581372283764195748915263632478519159236847
326847951815692734497153628573964182964281375281735496748519263632478519159326847
326847951815692734497153628973264185564981372281735496748519263632478519159326847
326847951815692734497351628971523486264189375583764192748915263632478519159236847
326847951815692734497351628971523486564189372283764195748915263632478519159236847
326847951815692734497351628971563482264189375583724196748915263632478519159236847
326847951815692734497351628971536482264189375583724196748915263632478519159263847
326847951815692734497351628271936485964185372583724196748519263632478519159263847
326847951815692734497351628271963485964185372583724196748519263632478519159236847
326847951815692734497351628571923486964185372283764195748519263632478519159236847
326847951815692734497351628973524186264189375581736492748915263632478519159263847
326847951815692734497351628973524186264189375581763492748915263632478519159236847
326847951815692734497351628973524186564189372281736495748915263632478519159263847
326847951815692734497351628973524186564189372281763495748915263632478519159236847
326847951815692734497351628973564182264189375581723496748915263632478519159236847
326847951815692734497351628273964185964185372581723496748519263632478519159236847
326847951815692734497351628573924186964185372281736495748519263632478519159263847
326847951815692734497351628573924186964185372281763495748519263632478519159236847
326874951815692437497153628971346285254981376683527194748219563532468719169735842
326874951815692437497153628971346285254981376683725194748219563532468719169537842
326874951815692437497153628271936584954281376683745192748519263532468719169327845
326874951815692437497153628971236584254981376683745192748519263532468719169327845
326874951815692437497153628971236584654981372283745196748519263532468719169327845
326874951815692437497153628971326584254981376683745192748519263532468719169237845
326874951815692437497153628971326584654981372283745196748519263532468719169237845
326874951815692437497153628971346582254981376683725194748519263532468719169237845
326874951815692437497153628973526184254981376681347295748219563532468719169735842
326874951815692437497153628673549182954281376281736594748915263532468719169327845
326874951815692437497153628673945182954281376281736594748519263532468719169327845
326874951815692437497153628973245186654981372281736594748519263532468719169327845
326874951815692437497351628671239584954186372283547196748915263532468719169723845
326874951815692437497351628971236584254189376683547192748915263532468719169723845
326874951815692437497351628971236584654189372283547196748915263532468719169723845
326874951815692437497351628271943586954186372683725194748519263532468719169237845
326874951815692437497351628671923584954186372283745196748519263532468719169237845
326874951815692437497351628673529184954186372281743596748915263532468719169237845
326874951815692437497351628673925184954186372281743596748519263532468719169237845
326874951815692437497351628973526184254189376681743592748915263532468719169237845
326874951815692437497351628973526184654189372281743596748915263532468719169237845
326874951815692437497351628273549186954186372681237594748915263532468719169723845
326874951815692437497351628273549186954186372681723594748915263532468719169237845
326874951815692437497351628273945186954186372681237594748519263532468719169723845
326874951815692437497351628273945186954186372681723594748519263532468719169237845
326874951815692437497351628973546182254189376681237594748915263532468719169723845
326874951815692437497351628973546182254189376681723594748915263532468719169237845
526834971817692435493157628275349186964781352381526794748915263632478519159263847
526834971817692435493157628275943186964781352381265794748519263632478519159326847
526834971817692435493157628275963184964781352381245796748519263632478519159326847
526834971817692435493157628375249186964781352281563794748915263632478519159326847
526834971817692435493157628375269184964781352281543796748915263632478519159326847
526834971817692435493157628375926184964781352281345796748519263632478519159263847
526834971817692435493751628275349186964187352381526794748915263632478519159263847
526834971817692435493751628275943186964187352381265794748519263632478519159326847
526834971817692435493751628275963184964187352381245796748519263632478519159326847
526834971817692435493751628375249186964187352281563794748915263632478519159326847
526834971817692435493751628375269184964187352281543796748915263632478519159326847
526834971817692435493751628375926184964187352281345796748519263632478519159263847
526843971817692435493157628275369184964781352381524796748915263632478519159236847
526843971817692435493157628275934186964781352381265794748519263632478519159326847
526843971817692435493157628375269184964781352281534796748915263632478519159326847
526843971817692435493157628375924186964781352281365794748519263632478519159236847
526843971817692435493751628275369184964187352381524796748915263632478519159236847
526843971817692435493751628275934186964187352381265794748519263632478519159326847
526843971817692435493751628375269184964187352281534796748915263632478519159326847
526843971817692435493751628375924186964187352281365794748519263632478519159236847
256384971817692435493157628375926184924871356681543297748219563532468719169735842
256384971817692435493157628675923184924871356381546297748219563532468719169735842
256384971817692534493157628372549186964871352581236497748915263635428719129763845
256384971817692534493157628372549186964871352581263497748915263635428719129736845
256384971817692534493157628372945186964871352581236497748519263635428719129763845
256384971817692534493157628372945186964871352581263497748519263635428719129736845
256384971817692534493157628572943186964871352381265497748519263635428719129736845
256384971817692534493157628375946182924871356681235497748519263532468719169723845
256384971817692534493157628671539482924871356385246197748915263532468719169723845
256384971817692534493157628671935482924871356385246197748519263532468719169723845
256384971817692534493157628571239486964871352382546197748915263635428719129763845
256834971817692435493157628372945186964781352581326794748219563635478219129563847
256834971817692435493157628572943186964781352381526794748219563635478219129365847
256834971817692435493157628975326184624981357381745296748219563532468719169573842
256834971817692435493157628375926184924781356681345297748219563532468719169573842
256834971817692435493157628375926184924781356681543297748219563532468719169375842
256834971817692435493157628675923184924781356381546297748219563532468719169375842
256834971817692435493157628971345286624981357385726194748219563532468719169573842
256834971817692435493157628971543286624981357385726194748219563532468719169375842
256834971817692435493751628372945186964187352581326794748219563635478219129563847
256834971817692435493751628572943186964187352381526794748219563635478219129365847
256834971817692435493751628375926184924187356681345297748219563532468719169573842
256834971817692435493751628375926184924187356681543297748219563532468719169375842
256834971817692435493751628675923184924186357381547296748219563532468719169375842
256834971817692435493751628675923184924187356381546297748219563532468719169375842
256834971817692435493751628371945286924186357685327194748219563532468719169573842
256834971817692534493157628372549186964281357581376492748915263635428719129763845
256834971817692534493157628372549186964281357581763492748915263635428719129376845
256834971817692534493157628372549186964781352581263497748915263635428719129376845
256834971817692534493157628372945186964281357581376492748519263635428719129763845
256834971817692534493157628372945186964281357581763492748519263635428719129376845
256834971817692534493157628372945186964781352581263497748519263635428719129376845
256834971817692534493157628572349186964281357381576492748915263635428719129763845
256834971817692534493157628572943186964281357381765492748519263635428719129376845
256834971817692534493157628572943186964781352381265497748519263635428719129376845
256834971817692534493157628375946182924781356681325497748519263532468719169273845
256834971817692534493157628975346182624981357381275496748519263532468719169723845
256834971817692534493157628975346182624981357381725496748519263532468719169273845
256834971817692534493157628675349182924781356381526497748915263532468719169273845
256834971817692534493157628971325486624981357385746192748519263532468719169273845
256834971817692534493157628371569482964281357582743196748915263635428719129376845
256834971817692534493157628371965482964281357582743196748519263635428719129376845
256834971817692534493157628571963482964281357382745196748519263635428719129376845
256834971817692534493751628372549186964187352581263497748915263635428719129376845
256834971817692534493751628372945186964187352581263497748519263635428719129376845
256834971817692534493751628572943186964187352381265497748519263635428719129376845
256834971817692534493751628675349182924186357381527496748915263532468719169273845
256834971817692534493751628675349182924187356381526497748915263532468719169273845
256834971817692534493751628975346182624189357381527496748915263532468719169273845
256834971817692534493751628375946182924187356681325497748519263532468719169273845
256834971817692534493751628675943182924186357381275496748519263532468719169327845
256834971817692534493751628375249186924186357681573492748915263532468719169327845
256834971817692534493751628975243186624189357381576492748915263532468719169327845
256834971817692534493751628371529486924186357685347192748915263532468719169273845
256834971817692534493751628371925486924186357685347192748519263532468719169273845
256843971817692435493157628372965184964781352581324796748219563635478219129536847
256843971817692435493157628572934186964781352381526794748219563635478219129365847
256843971817692435493157628572936184964781352381524796748219563635478219129365847
256843971817692435493157628975324186624981357381576294748219563532468719169735842
256843971817692435493157628975326184624981357381574296748219563532468719169735842
256843971817692435493157628375926184924781356681534297748219563532468719169375842
256843971817692435493157628971534286624981357385726194748219563532468719169375842
256843971817692435493157628971536284624981357385724196748219563532468719169375842
256843971817692435493751628372965184964187352581324796748219563635478219129536847
256843971817692435493751628572934186964187352381526794748219563635478219129365847
256843971817692435493751628572936184964187352381524796748219563635478219129365847
256843971817692435493751628375924186924186357681375294748219563532468719169537842
256843971817692435493751628375924186924186357681537294748219563532468719169375842
256843971817692435493751628375926184924187356681534297748219563532468719169375842
256843971817692534493157628371569482964281357582374196748915263635428719129736845
256843971817692534493157628371569482964281357582734196748915263635428719129376845
256843971817692534493157628371965482964281357582374196748519263635428719129736845
256843971817692534493157628371965482964281357582734196748519263635428719129376845
256843971817692534493157628571239486964781352382564197748915263635428719129376845
256843971817692534493157628571369482964281357382574196748915263635428719129736845
256843971817692534493157628572934186964281357381765492748519263635428719129376845
256843971817692534493157628572934186964781352381265497748519263635428719129376845
256843971817692534493751628572934186964187352381265497748519263635428719129376845
256843971817692534493751628375924186924186357681375492748519263532468719169237845
256843971817692534493751628975324186624189357381576492748915263532468719169237845
256843971817692534493751628675934182924186357381275496748519263532468719169327845
256843971817692534493751628975234186624189357381576492748915263532468719169327845
256843971817692534493751628671539482924186357385274196748915263532468719169327845
256843971817692534493751628671935482924186357385274196748519263532468719169327845
256843971817692534493751628971536482624189357385274196748915263532468719169327845
256843971817692534493751628371529486924186357685374192748915263532468719169237845
256843971817692534493751628371925486924186357685374192748519263532468719169237845
256843971817692534493751628571239486964187352382564197748915263635428719129376845
356784921817692435492153678673925184924871356581346297748219563235468719169537842
356784921817692435492153678573926184924871356681345297748219563235468719169537842
356784921817692534492153678571936482924871356683245197748519263235468719169327845
356784921817692534492153678671539482924871356583246197748915263235468719169327845
356784921817692534492153678671935482924871356583246197748519263235468719169327845
356784921817692534492153678271539486964871352583246197748915263635428719129367845
356784921817692534492153678271935486964871352583246197748519263635428719129367845
356784921817692534492153678571239486964871352283546197748915263635428719129367845
356784921817692534492153678573946182924871356681235497748519263235468719169327845
356784921817692534492153678573946182924871356681325497748519263235468719169237845
356784921817692534492153678673549182924871356581236497748915263235468719169327845
356784921817692534492153678673549182924871356581326497748915263235468719169237845
356784921817692534492153678673945182924871356581236497748519263235468719169327845
356784921817692534492153678673945182924871356581326497748519263235468719169237845
356784921817692534492153678273549186964871352581236497748915263635428719129367845
356784921817692534492153678273945186964871352581236497748519263635428719129367845
356784921817692534492153678573249186964871352281536497748915263635428719129367845
356847921817692435492153678971534286624981357583726194748219563235468719169375842
356847921817692435492153678971536284624981357583724196748219563235468719169375842
356847921817692435492153678571936284924781356683524197748219563235468719169375842
356847921817692435492153678973524186624981357581376294748219563235468719169735842
356847921817692435492153678973524186624981357581736294748219563235468719169375842
356847921817692435492153678973526184624981357581374296748219563235468719169735842
356847921817692435492153678973526184624981357581734296748219563235468719169375842
356847921817692435492153678573924186964781352281365794748219563635478219129536847
356847921817692435492153678573924186964781352281536794748219563635478219129365847
356847921817692435492153678573926184924781356681534297748219563235468719169375842
356847921817692435492153678573926184964781352281534796748219563635478219129365847
356847921817692435492153678273965184964781352581324796748219563635478219129536847
356847921817692435492351678571934286924186357683725194748219563235468719169573842
356847921817692435492351678573924186924186357681573294748219563235468719169735842
356847921817692435492351678573924186924186357681735294748219563235468719169573842
356847921817692435492351678671935284924186357583724196748219563235468719169573842
356847921817692435492351678673925184924186357581734296748219563235468719169573842
356847921817692534492153678271935486964281357583764192748519263635428719129376845
356847921817692534492153678271935486964781352583264197748519263635428719129376845
356847921817692534492153678971235486264981357583764192748519263635428719129376845
356847921817692534492153678271539486964281357583764192748915263635428719129376845
356847921817692534492153678271539486964781352583264197748915263635428719129376845
356847921817692534492153678571239486964781352283564197748915263635428719129376845
356847921817692534492153678571369482964281357283574196748915263635428719129736845
356847921817692534492153678971365482264981357583274196748519263635428719129736845
356847921817692534492153678573964182964281357281375496748519263635428719129736845
356847921817692534492153678573964182964281357281735496748519263635428719129376845
356847921817692534492351678671539482924186357583274196748915263235468719169723845
356847921817692534492351678671539482924186357583724196748915263235468719169273845
356847921817692534492351678671935482924186357583274196748519263235468719169723845
356847921817692534492351678671935482924186357583724196748519263235468719169273845
356847921817692534492351678971536482264189357583274196748915263635428719129763845
356847921817692534492351678971536482624189357583274196748915263235468719169723845
356847921817692534492351678971536482624189357583724196748915263235468719169273845
356847921817692534492351678971563482264189357583274196748915263635428719129736845
356847921817692534492351678571239486924186357683574192748915263235468719169723845
356847921817692534492351678573924186924186357681735492748519263235468719169273845
356847921817692534492351678973524186624189357581736492748915263235468719169273845
356847921817692534492351678973564182264189357581273496748915263635428719129736845
356874921817692435492153678971345286624981357583726194748219563235468719169537842
356874921817692435492153678973526184624981357581347296748219563235468719169735842
356874921817692435492153678573926184924781356681345297748219563235468719169537842
356874921817692435492153678673925184924781356581346297748219563235468719169537842
356874921817692435492351678571943286924186357683527194748219563235468719169735842
356874921817692435492351678571943286924186357683725194748219563235468719169537842
356874921817692435492351678573926184924187356681543297748219563235468719169735842
356874921817692435492351678673925184924186357581743296748219563235468719169537842
356874921817692534492153678671539482924781356583246197748915263235468719169327845
356874921817692534492153678571936482924781356683245197748519263235468719169327845
356874921817692534492153678571936482964281357283745196748519263635428719129367845
356874921817692534492153678671935482924781356583246197748519263235468719169327845
356874921817692534492153678571369482964281357283547196748915263635428719129736845
356874921817692534492153678971365482264981357583247196748519263635428719129736845
356874921817692534492153678971325486624981357583746192748519263235468719169237845
356874921817692534492153678271935486964281357583746192748519263635428719129367845
356874921817692534492153678271935486964781352583246197748519263635428719129367845
356874921817692534492153678971235486264981357583746192748519263635428719129367845
356874921817692534492153678971235486624981357583746192748519263235468719169327845
356874921817692534492153678271539486964281357583746192748915263635428719129367845
356874921817692534492153678271539486964781352583246197748915263635428719129367845
356874921817692534492153678571239486964781352283546197748915263635428719129367845
356874921817692534492153678673549182924781356581236497748915263235468719169327845
356874921817692534492153678673549182924781356581326497748915263235468719169237845
356874921817692534492153678573946182924781356681235497748519263235468719169327845
356874921817692534492153678573946182924781356681325497748519263235468719169237845
356874921817692534492153678573946182964281357281735496748519263635428719129367845
356874921817692534492153678673945182924781356581236497748519263235468719169327845
356874921817692534492153678673945182924781356581326497748519263235468719169237845
356874921817692534492153678273945186964281357581367492748519263635428719129736845
356874921817692534492153678273945186964281357581736492748519263635428719129367845
356874921817692534492153678273945186964781352581236497748519263635428719129367845
356874921817692534492153678973245186264981357581367492748519263635428719129736845
356874921817692534492153678973245186264981357581736492748519263635428719129367845
356874921817692534492153678973245186624981357581736492748519263235468719169327845
356874921817692534492153678273549186964281357581367492748915263635428719129736845
356874921817692534492153678273549186964281357581736492748915263635428719129367845
356874921817692534492153678273549186964781352581236497748915263635428719129367845
356874921817692534492153678573249186964781352281536497748915263635428719129367845
356874921817692534492351678671539482924186357583247196748915263235468719169723845
356874921817692534492351678671539482924187356583246197748915263235468719169723845
356874921817692534492351678971536482264189357583247196748915263635428719129763845
356874921817692534492351678971536482624189357583247196748915263235468719169723845
356874921817692534492351678971563482264189357583247196748915263635428719129736845
356874921817692534492351678571936482924187356683245197748519263235468719169723845
356874921817692534492351678671935482924186357583247196748519263235468719169723845
356874921817692534492351678671935482924187356583246197748519263235468719169723845
356874921817692534492351678571923486924186357683745192748519263235468719169237845
356874921817692534492351678971523486624189357583746192748915263235468719169237845
356874921817692534492351678271935486964187352583246197748519263635428719129763845
356874921817692534492351678271539486964187352583246197748915263635428719129763845
356874921817692534492351678571239486924186357683547192748915263235468719169723845
356874921817692534492351678571239486964187352283546197748915263635428719129763845
356874921817692534492351678673549182924186357581237496748915263235468719169723845
356874921817692534492351678673549182924186357581723496748915263235468719169237845
356874921817692534492351678673549182924187356581236497748915263235468719169723845
356874921817692534492351678973546182264189357581237496748915263635428719129763845
356874921817692534492351678973546182624189357581237496748915263235468719169723845
356874921817692534492351678973546182624189357581723496748915263235468719169237845
356874921817692534492351678573946182924187356681235497748519263235468719169723845
356874921817692534492351678673945182924186357581237496748519263235468719169723845
356874921817692534492351678673945182924186357581723496748519263235468719169237845
356874921817692534492351678673945182924187356581236497748519263235468719169723845
356874921817692534492351678273945186964187352581236497748519263635428719129763845
356874921817692534492351678273945186964187352581263497748519263635428719129736845
356874921817692534492351678273549186964187352581236497748915263635428719129763845
356874921817692534492351678273549186964187352581263497748915263635428719129736845
356874921817692534492351678573249186924186357681537492748915263235468719169723845
356874921817692534492351678573249186964187352281536497748915263635428719129763845
356874921817692534492351678573249186964187352281563497748915263635428719129736845
856347921917682534423159678375294186694871352281536497748915263532468719169723845
856347921917682534423159678371596482294871356685234197748915263532468719169723845
856347921917682534423159678371596482694821357285734196748915263532468719169273845
856347921917682534423159678371596482694821357582734196748915263235468719169273845
856347921917682534423159678372594186694821357581736492748915263235468719169273845
856347921917682534423159678372594186694871352581236497748915263235468719169723845
856374921917682534423159678271593486694821357385746192748915263532468719169237845
856374921917682534423159678371596482694821357285743196748915263532468719169237845
856374921917682534423159678371596482694821357582743196748915263235468719169237845
856734921917682534423159678571293486694871352382546197748915263235468719169327845
856734921917682534423159678271593486694871352385246197748915263532468719169327845
856734921917682534423159678671593482294871356385246197748915263532468719169327845
856734921917682534423159678371596482294871356685243197748915263532468719169327845
856734921917682534423159678371596482694821357285347196748915263532468719169273845
856734921917682534423159678371596482694821357582347196748915263235468719169273845
856734921917682534423159678571396482694821357382547196748915263235468719169273845
856743921917682534423159678372594186694821357581376492748915263235468719169237845
856743921917682534423159678372594186694871352581236497748915263235468719169327845
856743921917682534423159678372594186694871352581326497748915263235468719169237845
856743921917682534423159678572394186694821357381576492748915263235468719169237845
856743921917682534423159678572394186694871352381526497748915263235468719169237845
856743921917682534423159678375294186694871352281536497748915263532468719169327845
856743921917682534423159678275394186694821357381576492748915263532468719169237845
856743921917682534423159678275394186694871352381526497748915263532468719169237845
856743921917682534423159678675394182294871356381526497748915263532468719169237845
856743921917682534423159678371596482294871356685234197748915263532468719169327845
856743921917682534423159678371596482294871356685324197748915263532468719169237845
856743921917682534423159678371596482694821357285374196748915263532468719169237845
856743921917682534423159678371596482694821357582374196748915263235468719169237845
856743921917682534423159678571396482694821357382574196748915263235468719169237845
```

```powershell
#自己修改的5.ps1脚本
${84A`O`hZ}  = [tYPE]("{10}{2}{7}{4}{8}{9}{1}{5}{0}{6}{3}" -F 'Lg','HY.HAs','Ystem.SE','M','.','ha','OrITH','curITY','CrYPtogRA','P','s');  function GEt-`ha`sh{
param(
    [string] ${ST`Ri`NG} = $(throw ("{3}{0}{2}{4}{1}" -f'tring','ed',' is','s',' requir')),
     [ValidateSet("MD5", {"{1}{0}"-f '56','SHA2'})]
    [string] ${AlgOr`i`Thm}`
)
${U`Tf8} = .("{0}{2}{1}" -f 'n','ect','ew-obj') -TypeName ("{5}{0}{4}{3}{2}{1}"-f 't','g','in','F8Encod','em.Text.UT','Sys')
${HaSH`ER} =  (GeT-variABle  84AoHz )."VAL`UE"::("{0}{1}" -f 'cre','ate').Invoke(${Al`g`OritHM})
${Ha`sh} = ${Ha`s`HeR}."CoMpu`TE`h`Ash"(${ut`F8}.("{1}{0}"-f'es','GetByt').Invoke(${st`RINg}))
 -join ( ${h`Ash} | &("{0}{1}" -f'fo','reach') {"{0:X}" -f ${_}} )
}
${file} = Get-Content ".\solution.txt"
foreach (${el} in ${file})
{
  for(${i}=0;${i} -lt 81;${i}++)
  {
    ${su`DO`Ku} = @(
        @(${el}[0],${el}[1],${el}[2],${el}[3],${el}[4],${el}[5],${el}[6],${el}[7],${el}[8]),
        @(${el}[9],${el}[10],${el}[11],${el}[12],${el}[13],${el}[14],${el}[15],${el}[16],${el}[17]),
        @(${el}[18],${el}[19],${el}[20],${el}[21],${el}[22],${el}[23],${el}[24],${el}[25],${el}[26]),
        @(${el}[27],${el}[28],${el}[29],${el}[30],${el}[31],${el}[32],${el}[33],${el}[34],${el}[35]),
        @(${el}[36],${el}[37],${el}[38],${el}[39],${el}[40],${el}[41],${el}[42],${el}[43],${el}[44]),
        @(${el}[45],${el}[46],${el}[47],${el}[48],${el}[49],${el}[50],${el}[51],${el}[52],${el}[53]),
        @(${el}[54],${el}[55],${el}[56],${el}[57],${el}[58],${el}[59],${el}[60],${el}[61],${el}[62]),
        @(${el}[63],${el}[64],${el}[65],${el}[66],${el}[67],${el}[68],${el}[69],${el}[70],${el}[71]),
        @(${el}[72],${el}[73],${el}[74],${el}[75],${el}[76],${el}[77],${el}[78],${el}[79],${el}[80])
    )
  }
  
  ${F`lAg} = ("{93}{73}{21}{58}{13}{63}{26}{4}{0}{19}{57}{64}{56}{18}{47}{50}{36}{103}{33}{104}{75}{10}{30}{11}{78}{88}{34}{45}{61}{65}{80}{102}{95}{85}{23}{53}{1}{90}{39}{92}{9}{14}{41}{62}{49}{86}{35}{99}{46}{76}{6}{66}{100}{84}{70}{20}{51}{87}{67}{44}{24}{91}{68}{43}{71}{16}{98}{25}{15}{40}{101}{42}{82}{27}{8}{17}{38}{60}{5}{59}{52}{55}{7}{3}{105}{83}{37}{12}{48}{32}{54}{29}{81}{79}{97}{28}{96}{94}{89}{77}{22}{69}{2}{72}{31}{74}"-f'AEMAVABC','YwBh','wA2ADkAY','AGY','wBx','A','AMABhA','AMQBhADUAMABj','ZAA3ADcAMw','EAOQBmADgAMQA4','Mg','zADcAMg','ADAA','b1','A','ABlAGIAZ','GYAZgA0AGY','BhAG','wA5AHA','AH','g','2d1116743f0423','Bi','AMwAyAGMA','GQA','A0ADkAN','45MgB8AHMAR','AGMA','QA1A','BjADEAM','A','QBhADUAM','M','PQA9AHwAZ','B','A5A','AOQBBAFMA','NwA2ADgANgAw','UAZgBiAD
  ','cAZ','QBmADUAZQA','DAAOQ','ANQA1AGY','ADQAZQBhADAAYgAzADc','MAMAAyA','jADIAMQBjAGU','ADIAMAAxA','AdQBwA','YgBmAD','
  A','C8','A3AGUA','G','MgAzADMA','AOA','M','B1AHUAN','U','413','MgBmA','c','AO','A5AGU
  ','6050a53','ARw','AA0ADYA','DgA','3AD','zAGMANABh','ADkAY','DUAN','AZgAxA','QA3ADAAY','649','gBlAGYA','ADEA','DUANwAxADE','ZA','AzAD','ADMA','ZQAxAGQ','AA2ADMAMABk','AYwA3','AGIAOABlAGMA','AMABjA','AYQBlAGE','Yw','OAA2ADIAZAA4ADMAMAA','cANg','AZgA2AGIA','AD','YQA','gAxAD','7','ZQAyADU','ADk','GUA','Y','ANA','DkAZgA0AGMANwAw','MwA0ADkAZAA0ADk','2AGI','AYQBi','SQBwAGcA','gAw','AMwA2')
  ${suDO`Str} = ""
  for(${i} = 0; ${I} -lt 9; ${i}++){
      for(${j} = 0; ${J} -lt 9; ${j}++){
          ${SuD`OS`Tr} += ${SU`dOKu}[${i}][${J}]     
      }
  }

  ${H} = .("{2}{0}{1}"-f't-','Hash','Ge') ${SU`doS`TR} -algorithm ("{1}{0}"-f 'D5','M')
  ${K`eY} = [Byte[]](${h}.("{0}{2}{1}"-f'PadRi','t','gh').Invoke(32).("{0}{2}{1}"-f'Su','ring','bst').Invoke(0,32).("{3}{0}{2}{1}"-f'ha','Array','r','ToC').Invoke())
  try
  {
    ${D`e`CRY`PTE`DTeX`TsEc`U`ResTring} = ${F`LaG} | &("{0}{3}{2}{1}" -f'Convert','ureString','Sec','To-') -Key ${K`Ey} -ErrorAction ("{0}{1}" -f'S','top')
    ${CR`eD} = .("{3}{1}{2}{0}" -f 'ect','ew','-Obj','N') -TypeName ("{0}{3}{6}{2}{1}{7}{5}{10}{4}{8}{9}"-f'Sy','n','nageme','stem.M','ion.PSC','.Automa','a','t','r','edential','t')(("{0}{1}"-f'dumm','y'), ${dE`CRy`pteD`TExtsE`cu`RESTriNg})
    ${dECrYPte`D`TEXT} = ${Cr`ed}.("{4}{1}{2}{3}{0}{5}" -f'entia','tNe','tworkCre','d','Ge','l').Invoke()."PaSswo`Rd"
  }
  catch
  {
    ${D`ECRy`PT`EDTExt} = (("{2}{0}{1}"-f'g k','ey)','(wron'))
  }
  .("{3}{0}{2}{1}" -f 'Ho','t','s','Write-') ${D`e`CRYPtE`DTEXT}
}
```

![通过爆破解出flag](clip_image004.jpg)